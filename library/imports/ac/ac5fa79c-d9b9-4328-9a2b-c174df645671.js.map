{"version":3,"sources":["assets\\framework\\network\\ConnectManager.ts"],"names":[],"mappings":";;;;;;AAAA,mCAAkC;AAIlC;IAaC;QAFQ,cAAS,GAA6B,IAAI,CAAC;QAGlD,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;IACrB,CAAC;IAZa,0BAAW,GAAzB;QACC,IAAG,IAAI,CAAC,SAAS,IAAI,IAAI,EAAC;YACzB,IAAI,CAAC,SAAS,GAAG,IAAI,cAAc,EAAE,CAAC;SACtC;QACD,OAAO,IAAI,CAAC,SAAS,CAAC;IACvB,CAAC;IASM,+BAAM,GAAb,UAAc,IAAY,EAAE,IAAS;QACpC,IAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,IAAI,EAAC;YAC/B,IAAI,MAAM,GAAG,IAAI,eAAM,CAAC,IAAI,CAAC,CAAC;YAC9B,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;YAC9B,IAAG,IAAI,CAAC,WAAW,IAAI,IAAI;gBAC1B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;IACF,CAAC;IAEM,sCAAa,GAApB,UAAqB,GAAW;QAC/B,IAAG,GAAG,IAAI,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE;YACtC,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;SACvB;IACF,CAAC;IAEM,mCAAU,GAAjB;QACC,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IACvC,CAAC;IAEM,gCAAO,GAAd,UAAe,IAAY;QAC1B,IAAG,IAAI,IAAI,IAAI;YAAE,OAAO,IAAI,CAAC;QAC7B,IAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,IAAI,EAAC;YAC/B,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;SAC5B;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAEM,oCAAW,GAAlB,UAAmB,GAAY,EAAE,IAAa;QAC7C,IAAG,IAAI,IAAI,IAAI;YAAE,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;QACzC,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAC9B,IAAG,IAAI,IAAI,IAAI,EAAC;YACf,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;SACtB;IACF,CAAC;IAEM,wCAAe,GAAtB,UAAuB,IAAY;QAClC,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAC9B,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IAC5B,CAAC;IAEM,0CAAiB,GAAxB,UAAyB,GAAY;QACpC,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAC1C,IAAI,IAAI,IAAI,IAAI;YAAE,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;IAC/C,CAAC;IAEM,+BAAM,GAAb,UAAc,IAAY;QACzB,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAC9B,IAAG,IAAI,IAAI,IAAI,EAAC;YACf,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YAC5B,IAAI,CAAC,KAAK,EAAE,CAAC;SACb;IACF,CAAC;IAlEc,wBAAS,GAAmB,IAAI,CAAC;IAoEjD,qBAAC;CAtED,AAsEC,IAAA;AAEU,QAAA,WAAW,GAAmB,cAAc,CAAC,WAAW,EAAE,CAAC","file":"","sourceRoot":"/","sourcesContent":["import { Socket } from \"./Socket\";\r\nimport { Message } from \"./Message\";\r\n\r\n\r\nclass ConnectManager {\r\n\t\r\n\tprivate static _instance: ConnectManager = null;\r\n\tpublic static getInstance(): ConnectManager{\r\n\t\tif(this._instance == null){\r\n\t\t\tthis._instance = new ConnectManager();\r\n\t\t}\r\n\t\treturn this._instance;\r\n\t}\r\n\t\r\n\tprivate _defaultKey: string;\r\n\tprivate _allConns: { [name:string]: Socket} = null;\r\n\r\n\tpublic constructor(){\r\n\t\tthis._allConns = {};\r\n\t}\r\n\r\n\tpublic create(name: string, conf: any){\r\n\t\tif(this._allConns[name] == null){\r\n\t\t\tlet socket = new Socket(conf);\r\n\t\t\tthis._allConns[name] = socket;\r\n\t\t\tif(this._defaultKey == null)\r\n\t\t\t\tthis._defaultKey = name;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setDefaultKey(key: string){\r\n\t\tif(key != null && this._allConns[key]) {\r\n\t\t\tthis._defaultKey = key;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getDefault() {\r\n\t\treturn this.getConn(this._defaultKey);\r\n\t}\r\n\r\n\tpublic getConn(name: string){\r\n\t\tif(name == null) return null;\r\n\t\tif(this._allConns[name] != null){\r\n\t\t\treturn this._allConns[name];\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tpublic sendMessage(msg: Message, name?: string){\r\n\t\tif(name == null) name = this._defaultKey;\r\n\t\tlet conn = this.getConn(name);\r\n\t\tif(conn != null){\r\n\t\t\tconn.sendMessage(msg);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic enableHeartbeat(name: string) {\r\n\t\tlet conn = this.getConn(name);\r\n\t\tconn.enableHeartbeat(true);\r\n\t}\r\n\r\n\tpublic sendCustomMessage(msg: Message){\r\n\t\tlet conn = this.getConn(this._defaultKey);\r\n\t\tif (conn != null) conn.sendCustomMessage(msg);\r\n\t}\r\n\r\n\tpublic remove(name: string){\r\n\t\tlet conn = this.getConn(name);\r\n\t\tif(conn != null){\r\n\t\t\tdelete this._allConns[name];\r\n\t\t\tconn.close();\r\n\t\t}\r\n\t}\r\n\t\r\n}\r\n\r\nexport var connManager: ConnectManager = ConnectManager.getInstance();"]}