{"version":3,"sources":["assets\\framework\\qqsdk\\SoundHelper.ts"],"names":[],"mappings":";;;;;AAAA;IAAA;IA6IA,CAAC;IAtIG,wBAAwB;IAEjB,eAAG,GAAV;QACI,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;YAChC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;SACzB;QACD,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,EAAE,CAAC,GAAG,CAAC,OAAO,EAAC;YACnC,IAAI,CAAC,OAAO,GAAE;gBACV,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,EAAC,YAAY,GAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,EAAC,CAAC,CAAC,CAAC;gBACvD,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,EAAC,YAAY,GAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,EAAC,CAAC,CAAC,CAAC;gBACvD,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,EAAC,YAAY,GAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,EAAC,CAAC,CAAC,CAAC;aAC1D,CAAC;SACL;IACL,CAAC;IAAA,CAAC;IAGF,OAAO;IACA,qBAAS,GAAhB,UAAiB,GAAI;QACjB,GAAG,GAAG,GAAG,KAAI,SAAS,CAAA,CAAC,CAAA,CAAC,CAAA,CAAC,CAAA,GAAG,CAAC;QAC7B,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,EAAE,CAAC,GAAG,CAAC,OAAO,EAAC;YACnC,IAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAC;gBACzB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,UAAU,EAAE,CAAC;gBAC/B,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;aAC1B;iBAAI;gBACD,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;aACnC;YACD,IAAG,GAAG,KAAG,CAAC;gBAAE,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YAChC,OAAO;SACV;QAED,IAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAC;YACzB,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACrF;aAAI;YACD,EAAE,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;SAC7C;IACL,CAAC;IAAA,CAAC;IAIK,2BAAe,GAAtB;QAEI,IAAI,EAAE,GAAmB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QACvE,IAAG,CAAC,EAAE,EACN;YACI,EAAE,GAAG,EAAE,CAAC,kBAAkB,EAAE,CAAC;SAEhC;aAAI;YACD,IAAI,CAAC,aAAa,CAAC,GAAG,EAAE,CAAC;SAC5B;QACD,OAAO,EAAE,CAAC;IACd,CAAC;IAEM,sBAAU,GAAjB,UAAkB,KAAK;QAEnB,IAAI,KAAK,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,EAAC,YAAY,GAAC,KAAK,CAAC,QAAQ,EAAE,EAAC,CAAC,CAAC,CAAC;QAC5D,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;IAC5B,CAAC;IAED,MAAM;IACC,qBAAS,GAAhB,UAAiB,KAAK;QAClB,IAAG,IAAI,CAAC,cAAc,IAAI,IAAI;YAC1B,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC,kBAAkB,CAAC,EAAC,MAAM,EAAC,QAAQ,EAAC,CAAC,CAAC;QACnE,6CAA6C;QAC7C,IAAI,CAAC,cAAc,CAAC,GAAG,GAAG,YAAY,GAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;QACxD,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;QAC3B,gDAAgD;QAChD,mDAAmD;QACnD,OAAO;QACP,uBAAuB;QACvB,sCAAsC;QAClC,+CAA+C;QACnD,KAAK;IACT,CAAC;IAAA,CAAC;IAEF,OAAO;IACA,qBAAS,GAAhB,UAAiB,GAAG;QAChB,GAAG,GAAG,GAAG,KAAI,SAAS,CAAA,CAAC,CAAA,CAAC,CAAA,CAAC,CAAA,GAAG,CAAC;QAC7B,IAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,KAAI,CAAC,CAAC;YAAE,OAAO;QACpC,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,EAAE,CAAC,GAAG,CAAC,OAAO,EAAC;YACnC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,CAAC;YAC9B,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;YACxB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAI,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,EAAC,YAAY,GAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,SAAS,EAAC,CAAC,CAAC,CAAC,CAAA;YAC9E,OAAO;SACV;QACD,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;QACxC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;IAC5B,CAAC;IAAA,CAAC;IAEF,OAAO;IACA,sBAAU,GAAjB,UAAkB,GAAG;QACjB,GAAG,GAAG,GAAG,KAAI,SAAS,CAAA,CAAC,CAAA,CAAC,CAAA,CAAC,CAAA,GAAG,CAAC;QAC7B,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,EAAE,CAAC,GAAG,CAAC,OAAO,EAAC;YACnC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,UAAU,EAAE,CAAC;YAC/B,OAAO;SACV;QACD,IAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,KAAI,CAAC,CAAC,IAAI,EAAE,CAAC,WAAW,CAAC,UAAU,CAAC,OAAO,KAAK,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC;YAAE,OAAO;QACzH,EAAE,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;IAC7C,CAAC;IAAA,CAAC;IAEF,SAAS;IACF,uBAAW,GAAlB,UAAmB,IAAI;QACnB,IAAG,IAAI,EAAC;YACJ,IAAI,CAAC,SAAS,EAAE,CAAC;SACpB;aAAI;YACD,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;gBAChC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;aACtB;SACJ;IACL,CAAC;IAAA,CAAC;IACF,QAAQ;IACD,uBAAW,GAAlB,UAAmB,IAAI;IACvB,CAAC;IAAA,CAAC;IAEF,QAAQ;IACD,0BAAc,GAArB,UAAsB,KAAK;QACvB,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;QACzB,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;YAChC,IAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC,WAAW,CAAC,UAAU,CAAC,OAAO,KAAK,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAC;gBAC1G,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,EAAC,IAAI,CAAC,WAAW,CAAC,CAAC;aAC/D;SACJ;IACL,CAAC;IAAA,CAAC;IACF,QAAQ;IACD,0BAAc,GAArB,UAAsB,KAAK;QACvB,4BAA4B;IAChC,CAAC;IAAA,CAAC;IAGK,yBAAa,GAApB;QACI,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,EAAE,CAAC,GAAG,CAAC,OAAO;YAAE,OAAO;QAC/C,IAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,KAAI,CAAC,CAAC,IAAI,IAAI,CAAC,MAAM;YAAE,OAAO;QAC5E,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC;IAAA,CAAC;IA1IK,uBAAW,GAAC,CAAC,CAAC;IACd,iBAAK,GAAG,EAAE,CAAC;IACX,0BAAc,GAAO,IAAI,CAAC;IAE1B,kBAAM,GAAC,IAAI,CAAC;IAuCZ,yBAAa,GAAqB,EAAE,CAAA;IAiG/C,kBAAC;CA7ID,AA6IC,IAAA;kBA7IoB,WAAW","file":"","sourceRoot":"/","sourcesContent":["export default class SoundHelper{\n    static musicVolume=1;\n    static music = [];\n    static QQSoundContext:any = null;\n    static QQMusic:any;\n    static qqFlag=true;\n\n    // LIFE-CYCLE CALLBACKS:\n\n    static int() {\n        for(let i=0;i<this.music.length;i++){\n            this.music[i].id = -1;\n        }\n        if (cc.sys.platform === cc.sys.QQ_PLAY){\n            this.QQMusic =[\n                new BK.Audio(0,'GameRes://'+this.music[0].nativeUrl,-1),\n                new BK.Audio(0,'GameRes://'+this.music[1].nativeUrl,-1),\n                new BK.Audio(0,'GameRes://'+this.music[2].nativeUrl,-1),\n            ];\n        }\n    };\n\n\n    //播放背景音\n    static playMusic(num?){\n        num = num ===undefined?0:num;\n        if (cc.sys.platform === cc.sys.QQ_PLAY){\n            if(this.music[num].id === -1){\n                this.QQMusic[num].startMusic();\n                this.music[num].id = 1;\n            }else{\n                this.QQMusic[num].resumeMusic();\n            }\n            if(num!==0) this.qqFlag = false;\n            return;\n        }\n\n        if(this.music[num].id === -1){\n            this.music[num].id = cc.audioEngine.play(this.music[num], true, this.musicVolume);\n        }else{\n            cc.audioEngine.resume(this.music[num].id);\n        }\n    };\n\n    static _soundContext:BK.AudioElement[] = []\n\n    static getSoundContext():BK.AudioElement\n    {\n        let sc:BK.AudioElement = this._soundContext[this._soundContext.length];\n        if(!sc)\n        {\n            sc = BK.createAudioContext();\n            \n        }else{\n            this._soundContext.pop();\n        }\n        return sc;\n    }\n\n    static playSound2(sound)\n    {\n        let audio = new BK.Audio(1,'GameRes://'+sound.toString(),1);\n        audio.startMusic(sound);\n    }\n\n    //播放音效\n    static playSound(sound){\n        if(this.QQSoundContext == null)\n            this.QQSoundContext = BK.createAudioContext({\"type\":\"effect\"});\n        // let soundContext = this.getSoundContext();\n        this.QQSoundContext.src = \"GameRes://\"+sound.toString();\n        this.QQSoundContext.play();\n        // soundContext.play({complete:function(result){\n        //     SoundHelper._soundContext.push(soundContext)\n        // }});\n        // soundContext.play();\n        // soundContext.on(\"ended\",function(){\n            // SoundHelper._soundContext.push(soundContext)\n        // })\n    };\n\n    //停止背景音\n    static stopMusic(num){\n        num = num ===undefined?0:num;\n        if(this.music[num].id ===-1 )return;\n        if (cc.sys.platform === cc.sys.QQ_PLAY){\n            this.QQMusic[num].stopMusic();\n            this.music[num].id = -1;\n            this.QQMusic[num] =  new BK.Audio(0,'GameRes://'+this.music[num].nativeUrl,-1)\n            return;\n        }\n        cc.audioEngine.stop(this.music[num].id);\n        this.music[num].id = -1;\n    };\n\n    //暂停背景音\n    static pauseMusic(num){\n        num = num ===undefined?0:num;\n        if (cc.sys.platform === cc.sys.QQ_PLAY){\n            this.QQMusic[num].pauseMusic();\n            return;\n        }\n        if(this.music[num].id ===-1 || cc.audioEngine.AudioState.PLAYING !== cc.audioEngine.getState(this.music[num].id) )return;\n        cc.audioEngine.pause(this.music[num].id);\n    };\n\n    //设置背景音开关\n    static setMusicOff(bool){\n        if(bool){\n            this.playMusic();\n        }else{\n            for(let i=0;i<this.music.length;i++){\n                this.pauseMusic(i);\n            }\n        }\n    };\n    //设置音效开关\n    static setSoundOff(bool){\n    };\n\n    //设置背景音里\n    static setMusicVolume(value){\n        this.musicVolume = value;\n        for(let i=0;i<this.music.length;i++){\n            if(this.music[i].id !== -1 && cc.audioEngine.AudioState.PLAYING === cc.audioEngine.getState(this.music[i].id)){\n                cc.audioEngine.setVolume(this.music[i].id,this.musicVolume);\n            }\n        }\n    };\n    //设置音效音量\n    static setSoundVolume(value){\n        // this.soundVolume = value;\n    };\n\n\n    static qqMusicResume(){\n        if (cc.sys.platform !== cc.sys.QQ_PLAY) return;\n        if(this.music[1].id !== -1 || this.music[2].id!== -1 || this.qqFlag) return;\n        this.playMusic(0);\n    };\n\n}\n"]}