{"version":3,"sources":["assets\\Game\\Scripts\\ui\\WinDialog.ts"],"names":[],"mappings":";;;;;AAAA,gCAA+C;AAC/C,wDAAmD;AACnD,+EAA0E;AAC1E,mDAA8C;AAC9C,sDAAmE;AAE7D,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAuC,6BAAY;IAAnD;QAAA,qEA+NC;QA3NG,QAAE,GAAqB,IAAI,CAAC;QAG5B,gBAAU,GAAa,IAAI,CAAC;QAG5B,iBAAW,GAAa,IAAI,CAAC;QAG7B,sBAAgB,GAAa,IAAI,CAAC;QAElC,qBAAe,GAAa,IAAI,CAAC;QAEjC,eAAS,GAAa,IAAI,CAAC;QAE3B,iBAAW,GAAa,IAAI,CAAC;QAE7B,kBAAY,GAAa,IAAI,CAAC;QAE9B,oBAAc,GAAa,IAAI,CAAC;QAEhC,oBAAc,GAAa,IAAI,CAAC;QAEhC,oBAAc,GAAa,IAAI,CAAC;QAGhC,eAAS,GAAY,IAAI,CAAC;QAG1B,eAAS,GAAY,IAAI,CAAC;QAG1B,kBAAY,GAAY,IAAI,CAAC;QAG7B,kBAAY,GAAY,IAAI,CAAC;QAG7B,iBAAW,GAAY,IAAI,CAAC;QAG5B,iBAAW,GAAW,EAAE,CAAC;QAEzB,iBAAW,GAAW,EAAE,CAAC;QAEzB,kBAAY,GAAW,EAAE,CAAC;;IA8K9B,CAAC;IA3KG,0BAAM,GAAN,cAAW,CAAC;IACZ,4BAAQ,GAAR;QACI,QAAQ,yBAAe,CAAC,QAAQ,CAAC,eAAe,EAAE;YAC9C,KAAK,8BAAY,CAAC,EAAE;gBAChB,IAAI,CAAC,cAAc,CAAC,MAAM,EACtB,0BAA0B,EAC1B,GAAG,EACH,QAAQ,EACR,OAAO,EACP,MAAM,EACN,KAAK,EACL,MAAM,EACN,MAAM,CACT,CAAC;gBACF,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC1C,MAAM;YACV,KAAK,8BAAY,CAAC,EAAE;gBAChB,IAAI,CAAC,cAAc,CAAC,+BAA+B,EAC/C,8CAA8C,EAC9C,MAAM,EACN,0BAA0B,EAC1B,6BAA6B,EAC7B,gBAAgB,EAChB,kBAAkB,EAClB,qBAAqB,EACrB,kBAAkB,CACrB,CAAC;gBACF,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAE1C,MAAM;YACV,KAAK,8BAAY,CAAC,EAAE;gBAChB,IAAI,CAAC,cAAc,CAAC,4BAA4B,EAC5C,qCAAqC,EACrC,OAAO,EACP,uBAAuB,EACvB,yBAAyB,EACzB,cAAc,EACd,YAAY,EACZ,YAAY,EACZ,oBAAoB,CAEvB,CAAC;gBACF,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;gBAC3C,MAAM;SACb;IACT,CAAC;IAGG,kCAAc,GAAd,UACI,iBAAyB,EACzB,sBAA8B,EAC9B,qBAA6B,EAC7B,eAAuB,EACvB,iBAAyB,EACzB,kBAA0B,EAC1B,oBAA4B,EAC5B,oBAA4B,EAC5B,oBAA4B;QAE5B,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,iBAAiB,CAAC;QAC5C,IAAI,CAAC,gBAAgB,CAAC,MAAM,GAAG,sBAAsB,CAAC;QACtD,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,qBAAqB,CAAC;QACpD,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,qBAAqB,CAAC;QAC9C,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,iBAAiB,CAAC;QAC5C,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,kBAAkB,CAAC;QAC9C,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,oBAAoB,CAAC;QAClD,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,oBAAoB,CAAC;QAClD,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,oBAAoB,CAAC;IACtD,CAAC;IAED,sCAAkB,GAAlB,UAAmB,QAAgB;QAC/B,IAAI,yBAAe,CAAC,QAAQ,CAAC,eAAe,IAAI,8BAAY,CAAC,EAAE;YAC3D,IAAI,CAAC,WAAW,CAAC,QAAQ,IAAI,CAAC,CAAC;QACnC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC1C,IAAI,CAAC,eAAe,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzC,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACnC,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACrC,IAAI,CAAC,YAAY,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACtC,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACxC,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACxC,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC5C,CAAC;IAED,2BAAO,GAAP;QAEI,IAAI,CAAC,EAAE,CAAC,WAAW,EAAE,CAAC;QACtB,kBAAQ,CAAC,aAAa,EAAE,CAAC;QACzB,QAAQ,yBAAe,CAAC,QAAQ,CAAC,eAAe,EAAE;YAC9C,KAAK,8BAAY,CAAC,EAAE;gBAChB,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,aAAa,EAAE,eAAQ,CAAC,YAAY,CAAC,CAAA;gBAE9E,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC1C,MAAM;YACV,KAAK,8BAAY,CAAC,EAAE;gBAChB,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,gBAAgB,EAAE,eAAQ,CAAC,YAAY,CAAC,CAAA;gBAEjF,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAE1C,MAAM;YACV,KAAK,8BAAY,CAAC,EAAE;gBAChB,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,eAAe,EAAE,eAAQ,CAAC,YAAY,CAAC,CAAA;gBAEhF,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC1C,MAAM;SACb;QACD,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,eAAQ,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAA;QACpD,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,eAAQ,CAAC,UAAU,CAAC,QAAQ,EAAE,GAAE,GAAG,CAAC;QAC5D,IAAI,CAAC,GAAG,CAAC,CAAC,cAAc,CAAC,IAAI,EAAC,GAAG,EAAC,eAAQ,CAAC,UAAU,GAAG,eAAQ,CAAC,QAAQ,EAAC,eAAQ,CAAC,YAAY,GAAG,EAAE,CAAE,CAAA;QACtG,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,GAAE,GAAG,CAAE,CAAC,OAAO,CAAC,CAAC,CAAC,GAAE,GAAG,CAAA;QAEpD,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,KAAK,CAAA;QAE/B,IAAG,eAAQ,CAAC,KAAK,IAAI,eAAQ,CAAC,YAAY,EAC1C;YACI,IAAI,IAAE,GAAG,eAAQ,CAAC,KAAK,CAAA;YACvB,IAAI,QAAM,GAAG,eAAQ,CAAC,SAAS,CAAC,iBAAU,CAAC,OAAO,CAAC,CAAC;YACpD,IAAG,QAAM,GAAG,CAAC,IAAI,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,IAAI,IAAE,IAAI,CAAC,EAC/C;gBACI,IAAI,CAAC,YAAY,CAAC,UAAA,CAAC;oBACf,qBAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,oBAAoB,EAAC,IAAE,EAAC,CAAC,CAAC,CAAA;gBACxD,CAAC,EAAC,CAAC,CAAC,CAAA;gBACJ,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,KAAK,CAAA;aAClC;iBAAI;gBACD,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC;gBAC/B,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;gBAClB,IAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,EAAC,EAAE,CAAC,CAAC,CAAA;gBAC7C,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,OAAO,CAAC,QAAQ,EAAE,CAAC;gBAC9C,eAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;aAChC;YACD,eAAQ,CAAC,KAAK,GAAG,IAAE,GAAG,CAAC,CAAA;YACvB,kBAAQ,CAAC,WAAW,CAAC,eAAQ,CAAC,KAAK,CAAC,CAAC;YACrC,eAAQ,CAAC,IAAI,EAAE,CAAC;SACnB;QACD,IAAI,MAAM,GAAG,eAAQ,CAAC,SAAS,CAAC,iBAAU,CAAC,EAAE,CAAC,CAAC;QAC/C,IAAG,MAAM,IAAI,CAAC,EACd;YACI,IAAG,eAAQ,CAAC,KAAK,IAAI,CAAC,EACtB;gBACI,IAAG,CAAC,eAAQ,CAAC,QAAQ,CAAC,gBAAM,CAAC,UAAU,CAAC,EACxC;oBACI,qBAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,CAAA;iBAC7C;aACJ;SACJ;IACL,CAAC;IAED,8BAAU,GAAV;QAEI,qBAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAA;IACpD,CAAC;IAED,8BAAU,GAAV;QAEI,qBAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;IACjD,CAAC;IAED,8BAAU,GAAV;QAEI,eAAQ,CAAC,YAAY,GAAG,eAAQ,CAAC,YAAY,GAAE,CAAC,CAAC;QACjD,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,CAAA;IACjC,CAAC;IAED,8BAAU,GAAV;QAEI,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,CAAA;IACjC,CAAC;IAED,+BAAW,GAAX;QAEI,kBAAQ,CAAC,KAAK,EAAE,CAAC;IACrB,CAAC;IA1ND;QADC,QAAQ,CAAC,EAAE,CAAC,cAAc,CAAC;yCACA;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;iDACS;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;kDACU;IAG7B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;uDACe;IAElC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;sDACc;IAEjC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;gDACQ;IAE3B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;kDACU;IAE7B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;mDACW;IAE9B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;qDACa;IAEhC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;qDACa;IAEhC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;qDACa;IAGhC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;gDACO;IAG1B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;gDACO;IAG1B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;mDACU;IAG7B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;mDACU;IAG7B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;kDACU;IAG5B;QADC,QAAQ,CAAC,EAAE,IAAI,EAAE,EAAE,CAAC,OAAO,EAAE,CAAC;kDACN;IAEzB;QADC,QAAQ,CAAC,EAAE,IAAI,EAAE,EAAE,CAAC,OAAO,EAAE,CAAC;kDACN;IAEzB;QADC,QAAQ,CAAC,EAAE,IAAI,EAAE,EAAE,CAAC,OAAO,EAAE,CAAC;mDACL;IAjDT,SAAS;QAD7B,OAAO;OACa,SAAS,CA+N7B;IAAD,gBAAC;CA/ND,AA+NC,CA/NsC,EAAE,CAAC,SAAS,GA+NlD;kBA/NoB,SAAS","file":"","sourceRoot":"/","sourcesContent":["import { UserInfo, ChoiceType } from \"../Info\";\r\nimport Platform from \"../../../framework/Platform\";\r\nimport ViewManager from \"../../../framework/plugin_boosts/ui/ViewManager\";\r\nimport Consts from \"../hex-lines-game/Consts\";\r\nimport LanguageManager, { LanguageMode } from \"../LanguageManager\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class WinDialog extends cc.Component {\r\n\r\n\r\n    @property(cc.ParticleSystem)\r\n    ps:cc.ParticleSystem = null;\r\n\r\n    @property(cc.Label)\r\n    levelLabel: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    bannerLabel: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    achievementLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    amountStepLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    rankLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    rewardLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    messageLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    nextLevelLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    skinStoreLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    challengeLabel: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    stepLabel:cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    timeLabel:cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    percentLabel:cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    diamondLabel:cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    diamondNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Integer })\r\n    ch_FontSize: number = 25;\r\n    @property({ type: cc.Integer })\r\n    vi_FontSize: number = 16;\r\n    @property({ type: cc.Integer })\r\n    eng_FontSize: number = 20;\r\n\r\n\r\n    onLoad() { }\r\n    onEnable() {\r\n        switch (LanguageManager.instance.currentLanguage) {\r\n            case LanguageMode.CN:\r\n                this.set_label_lang(\"恭喜过关\",\r\n                    \"用时        超过了         玩家\",\r\n                    \"步\",\r\n                    \"查看完整排行\",\r\n                    \"本关奖励：\",\r\n                    \"太厉害了\",\r\n                    \"下一关\",\r\n                    \"皮肤商店\",\r\n                    \"发起挑战\",\r\n                );\r\n                this.set_label_FontSize(this.ch_FontSize);\r\n                break;\r\n            case LanguageMode.VI:\r\n                this.set_label_lang(\"Xin chúc mừng bạn đã vượt qua\",\r\n                    \"Thời gian        vượt quá         Người chơi\",\r\n                    \"bước\",\r\n                    \"Xem bảng xếp hạng đầy đủ\",\r\n                    \"Phần thưởng cho cấp độ này:\",\r\n                    \"Thật tuyệt vời\",\r\n                    \"Cấp độ tiếp theo\",\r\n                    \"Cửa hàng trang phục\",\r\n                    \"Đưa ra thử thách\",\r\n                );\r\n                this.set_label_FontSize(this.vi_FontSize);\r\n\r\n                break;\r\n            case LanguageMode.EN:\r\n                this.set_label_lang(\"Congratulations on passing\",\r\n                    \"Time        Exceeded         Player\",\r\n                    \"steps\",\r\n                    \"View the full ranking\",\r\n                    \"Rewards for this level:\",\r\n                    \"It's amazing\",\r\n                    \"Next Level\",\r\n                    \"Skin Store\",\r\n                    \"Launch a challenge\",\r\n\r\n                );\r\n                this.set_label_FontSize(this.eng_FontSize);\r\n                break;\r\n        }\r\n}\r\n\r\n\r\n    set_label_lang(\r\n        bannerLabelString: string,\r\n        achievementLabelString: string,\r\n        amountStepLabelString: string,\r\n        rankLabelString: string,\r\n        rewardLabelString: string,\r\n        messageLabelString: string,\r\n        nextLevelLabelString: string,\r\n        skinStoreLabelString: string,\r\n        challengeLabelString: string,\r\n    ) {\r\n        this.bannerLabel.string = bannerLabelString;\r\n        this.achievementLabel.string = achievementLabelString;\r\n        this.amountStepLabel.string = amountStepLabelString;\r\n        this.rankLabel.string = amountStepLabelString;\r\n        this.rewardLabel.string = rewardLabelString;\r\n        this.messageLabel.string = messageLabelString;\r\n        this.nextLevelLabel.string = nextLevelLabelString;\r\n        this.skinStoreLabel.string = skinStoreLabelString;\r\n        this.challengeLabel.string = challengeLabelString;\r\n    }\r\n\r\n    set_label_FontSize(fontSize: number) {\r\n        if (LanguageManager.instance.currentLanguage == LanguageMode.VI)\r\n            this.bannerLabel.fontSize -= 4;\r\n        this.achievementLabel.fontSize = fontSize;\r\n        this.amountStepLabel.fontSize = fontSize;\r\n        this.rankLabel.fontSize = fontSize;\r\n        this.rewardLabel.fontSize = fontSize;\r\n        this.messageLabel.fontSize = fontSize;\r\n        this.nextLevelLabel.fontSize = fontSize;\r\n        this.skinStoreLabel.fontSize = fontSize;\r\n        this.challengeLabel.fontSize = fontSize;\r\n    }\r\n\r\n    onShown()\r\n    {\r\n        this.ps.resetSystem();\r\n        Platform.showSmallRank();\r\n        switch (LanguageManager.instance.currentLanguage) {\r\n            case LanguageMode.CN:\r\n                this.levelLabel.string = cc.js.formatStr(\"- 第 %s 关 - \", UserInfo.currentLevel)\r\n\r\n                this.set_label_FontSize(this.ch_FontSize);\r\n                break;\r\n            case LanguageMode.VI:\r\n                this.levelLabel.string = cc.js.formatStr(\"- Cấp độ %s - \", UserInfo.currentLevel)\r\n\r\n                this.set_label_FontSize(this.vi_FontSize);\r\n\r\n                break;\r\n            case LanguageMode.EN:\r\n                this.levelLabel.string = cc.js.formatStr(\"- Level %s - \", UserInfo.currentLevel)\r\n\r\n                this.set_label_FontSize(this.vi_FontSize);\r\n                break;\r\n        }\r\n        this.stepLabel.string = UserInfo.stepUsed.toString()\r\n        this.timeLabel.string = UserInfo.timePassed.toString() +\"s\";\r\n        let p = g.decreaseFomula(0.99,0.3,UserInfo.timePassed + UserInfo.stepUsed,UserInfo.currentLevel + 50 )\r\n        this.percentLabel.string = (p* 100 ).toFixed(0) +\"%\"\r\n\r\n        this.diamondNode.active = false\r\n        \r\n        if(UserInfo.level == UserInfo.currentLevel)\r\n        {\r\n            let lv = UserInfo.level\r\n            let choise = UserInfo.getChoice(ChoiceType.Levelup);\r\n            if(choise > 0 && Math.random() > 0.5 && lv >= 3)\r\n            {\r\n                this.scheduleOnce(_=>{\r\n                    ViewManager.instance.show(\"Game/LevelupDialog\",lv,p)\r\n                },1)\r\n                this.diamondNode.active = false\r\n            }else{\r\n                this.diamondNode.active = true;\r\n                p = Math.min(p,1);\r\n                let diamond = Math.floor(Math.max(30 * p,10))\r\n                this.diamondLabel.string = diamond.toString();\r\n                UserInfo.addDiamond(diamond);\r\n            }\r\n            UserInfo.level = lv + 1\r\n            Platform.uploadScore(UserInfo.level);\r\n            UserInfo.save();\r\n        }\r\n        let choise = UserInfo.getChoice(ChoiceType.HB);\r\n        if(choise == 1)\r\n        {\r\n            if(UserInfo.level >= 3)\r\n            {\r\n                if(!UserInfo.isUnlock(Consts.FreeSkinId))\r\n                {\r\n                    ViewManager.instance.show(\"Game/HbDialog\")\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    click_rank()\r\n    {\r\n        ViewManager.instance.show(\"wechat/WxRankDialog\")\r\n    }\r\n\r\n    click_shop()\r\n    {\r\n        ViewManager.instance.show(\"Game/ShopDialog\");\r\n    }\r\n\r\n    click_next()\r\n    {\r\n        UserInfo.currentLevel = UserInfo.currentLevel +1;\r\n        cc.director.loadScene(\"Game\")\r\n    }\r\n\r\n    click_home()\r\n    {\r\n        cc.director.loadScene(\"Main\")\r\n    }\r\n\r\n    click_share()\r\n    {\r\n        Platform.share();\r\n    }\r\n}"]}