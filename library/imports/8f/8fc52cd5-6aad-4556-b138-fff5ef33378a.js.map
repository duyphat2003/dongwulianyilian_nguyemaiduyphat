{"version":3,"sources":["assets\\framework\\Platform.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { wxsdk } from \"./wxsdk/sdk\";\r\nimport { Toast } from \"./plugin_boosts/ui/ToastManager\";\r\nimport BKTool from \"./qqsdk/BKTool\";\r\nimport Device from \"./plugin_boosts/gamesys/Device\";\r\nimport SpriteFrameCache from \"./plugin_boosts/misc/SpriteFrameCache\";\r\nimport Signal from \"./plugin_boosts/misc/Signal\";\r\nimport { event } from \"./plugin_boosts/utils/EventManager\";\r\n\r\nenum WxCommands\r\n{\r\n    Hide = 99,\r\n    Next,\r\n    RankSmall,\r\n    Rank,\r\n}\r\n\r\nexport default class Platform\r\n{\r\n    static bannnerRefreshEnabled = true;\r\n    static onEnterForegroundSignal = new Signal();\r\n\r\n    static isAndroid = false\r\n    static isIOS = false;\r\n\r\n    static getOpenID()\r\n    {\r\n        if(cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            // wechat \r\n            let userInfo = wxsdk.userInfo\r\n            if(userInfo && userInfo.openID )\r\n            {\r\n                return userInfo.openID\r\n            }else{\r\n                return \"\"\r\n            }\r\n        }else if (cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            return GameStatusInfo.openId;\r\n        }else{\r\n            return \"123\"\r\n        }\r\n    }\r\n\r\n    static getNick()\r\n    {\r\n        if (cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            return BKTool.getNick();\r\n        }else if (cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            return  (wxsdk.userInfo && wxsdk.userInfo.nickName)  || \"自已\"\r\n        }else{\r\n            return \"玩家自已\"\r\n        }\r\n    }\r\n\r\n    static getHead()\r\n    {\r\n        if (cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            return BKTool.getHead();\r\n        }else if (cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            // avatarUrl:\"https://wx.qlogo.cn/mmopen/vi_32/QlHaicGZOD7do9LuX5W4APHYSrUBqVaGULuwISLUf35IyOOYZ3IXl7nF5mW36JiaQ9snziawrAvkknX41SmeYa9AQ/132\"city:\"\"country:\"\"gender:1language:\"zh_CN\"nickName:\"Damon Ren⁶⁶⁶\"province:\"\"\r\n            let userInfo = wxsdk.userInfo\r\n            if(userInfo && userInfo.avatarUrl )\r\n            {\r\n                return userInfo.avatarUrl\r\n            }else{\r\n                return \"https://tank.wdfunny.com/speed_logo/2.jpg\"\r\n            }\r\n        }\r\n        return \"https://tank.wdfunny.com/speed_logo/1.jpg\"\r\n    }\r\n\r\n    private static loadHeadQQ(sp)\r\n    {\r\n        let self = this;\r\n        let absolutePath = \"GameSandBox://_head/\" + GameStatusInfo.openId + \".jpg\";\r\n        let isExit = BK.FileUtil.isFileExist(absolutePath);\r\n        cc.log(absolutePath + \" is exit :\" + isExit);\r\n        //如果指定目录中存在此图像就直接显示否则从网络获取\r\n        if (isExit) {\r\n            cc.loader.load(absolutePath, function (err, texture) {\r\n                if (err == null) {\r\n                    sp.spriteFrame = new cc.SpriteFrame(texture);\r\n                }\r\n            });\r\n        } else {\r\n            BK.MQQ.Account.getHeadEx(GameStatusInfo.openId, function (oId, imgPath) {\r\n                cc.log(\"openId:\" + oId + \" imgPath:\" + imgPath);\r\n                var image = new Image();\r\n                image.onload = function () {\r\n                    var tex = new cc.Texture2D();\r\n                    tex.initWithElement(image);\r\n                    tex.handleLoadedTexture();\r\n                    sp.spriteFrame = new cc.SpriteFrame(tex);\r\n                }\r\n                image.src = imgPath;\r\n            });\r\n        }\r\n    }\r\n\r\n    static loadSelfHead(sprite)\r\n    {\r\n        if (cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            this.loadHeadQQ(sprite);\r\n        }else{\r\n            SpriteFrameCache.instance.getSpriteFrame(Platform.getHead()).then(sf=>sprite.spriteFrame = sf)\r\n        }\r\n    }\r\n\r\n    static exit()\r\n    {\r\n        if(cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            wx.offShow(Platform.onEnterForeground)\r\n            wx.offHide(Platform.onEnterBackground)\r\n        }else if (cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            \r\n        }\r\n    }\r\n\r\n    static configGetSignal:Signal = new Signal();\r\n\r\n    static login()\r\n    {\r\n        this.isAndroid = cc.sys.os == \"Android\"\r\n        console.log(\"================= os\" , cc.sys.os);\r\n        this.isIOS = cc.sys.os == \"iOS\"\r\n        if(cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            wxsdk.login()\r\n            wxsdk.requestConfig(data=>{\r\n                this.configGetSignal.fire(data)\r\n            })\r\n            // get conf \r\n            wx.onShow(Platform.onEnterForeground)\r\n            wx.onHide(Platform.onEnterBackground)\r\n        }else if (cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            BKTool.login();\r\n            BK.onEnterForeground(Platform.onEnterForeground);\r\n            BK.onEnterBackground(Platform.onEnterBackground);\r\n        }\r\n    }\r\n\r\n    static requestServerConfigs(name,callback,target)\r\n    {\r\n        if(cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            wxsdk.requestDB(name,callback,target)\r\n        }\r\n    }\r\n\r\n    static getGameID()\r\n    {\r\n        if (cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            GameStatusInfo.gameId;\r\n        }\r\n        return \"speed_wanyiwan\";\r\n    }\r\n\r\n\r\n    static getLaunchOptions()\r\n    {\r\n        if(cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            return wx.getLaunchOptionsSync()\r\n        }\r\n        return {}\r\n    }\r\n\r\n    \r\n\r\n\r\n    static getCity()\r\n    {\r\n        return \"\"\r\n    }\r\n\r\n    static share(callback?,target?)\r\n    {\r\n        console.log(\"######开始分享\")\r\n        if(cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            wxsdk.openShare();\r\n            let t = new Date().getTime()\r\n            Platform.onEnterForegroundSignal.on(()=>{\r\n                Platform.onEnterForegroundSignal.clear();\r\n                let d = new Date().getTime() - t;\r\n                if(d > 2333)\r\n                {\r\n                    setTimeout(_=>{\r\n                        if(callback)\r\n                            callback.call(target)\r\n                    },500)\r\n                }else{\r\n                    //用户及时返回分享失败 \r\n                    Toast.make(\"分享失败,请尝试换其它群分享\")\r\n                }\r\n            })\r\n        }else if(cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            BKTool.share(v=>{\r\n                if(v==\"success\")\r\n                {\r\n                    callback &&  callback.call(target)\r\n                }else{\r\n                    // Toast.make(\"分享失败\")\r\n                }\r\n            })\r\n        }else{\r\n            callback &&  callback.call(target)\r\n        }\r\n    }\r\n\r\n    static watch_video(callback,target?)\r\n    {\r\n        console.log(\"######开始看视频\")\r\n        if(cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            wxsdk.loadVideoAd((code,isEnded)=>{\r\n                if(code == \"load\")\r\n                {\r\n                    cc.audioEngine.pauseMusic();\r\n                    Platform.bannnerRefreshEnabled = false;\r\n                }\r\n                else if(code == \"close\")\r\n                {\r\n                    Platform.bannnerRefreshEnabled = true;\r\n                    if(!isEnded)\r\n                        Toast.make(\"必须看完视频,才能获取奖励\")\r\n                    else\r\n                        callback && callback.call(target)\r\n                }\r\n            })\r\n        }else if(cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            //关闭背景\r\n            cc.audioEngine.pauseMusic();\r\n            let isFinish = false;\r\n            BKTool.loadVideoAd((v,video)=>{\r\n                if(v == \"load\")\r\n                {\r\n                    video.show()\r\n                }else if (v == \"finish\")\r\n                {\r\n                    isFinish = true;\r\n                    \r\n                }else if (v==\"close\")\r\n                {\r\n                    if(!isFinish)\r\n                        Toast.make(\"必须看完视频,才能获取奖励\")\r\n                    else\r\n                        callback && callback.call(target)\r\n                }\r\n            });\r\n        }else{\r\n            callback &&  callback.call(target)\r\n        }\r\n    }\r\n\r\n    static showBannerAd()\r\n    {\r\n        console.log(\"######显示Banner广告\")\r\n        if(cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            wxsdk.showBannerAd();\r\n        }else if(cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            BKTool.showBannerAd();\r\n        }else{\r\n\r\n        }\r\n    }\r\n\r\n    static initBannerAd(b = 1)\r\n    {\r\n        if(b == 0) return;\r\n        if(cc.sys.QQ_PLAY == cc.sys.platform)\r\n        {\r\n            setInterval(_=>{\r\n                console.log(\"######加载Banner广告\")\r\n                BKTool.hideBannerAd()\r\n                BKTool.loadBannerAd(v=>{\r\n                    v == \"load\" && BKTool.showBannerAd();\r\n                })\r\n            } , 30000 )\r\n        }else if (cc.sys.WECHAT_GAME == cc.sys.platform)\r\n        {\r\n            setInterval(_=>{\r\n                if(Platform.bannnerRefreshEnabled)\r\n                {\r\n                    console.log(\"######加载Banner广告\")\r\n                    wxsdk.hideBannerAd()\r\n                    wxsdk.loadBannerAd(v=>{\r\n                        v == \"load\" && wxsdk.showBannerAd();\r\n                    })\r\n                }\r\n            } , 40000 )\r\n        }\r\n    }\r\n\r\n    static jumpTo()\r\n    {\r\n        // var desGameId = 1234; //跳转的gameid，必须为数字\r\n        // var extendInfo = \"\"; //额外参数，必须为字符串\r\n        // BK.QQ.skipGame(desGameId, extendInfo);\r\n    }\r\n\r\n    static showRankDialog()\r\n    {\r\n        console.log(\"[Platform]#showRankDialog\");\r\n        Toast.make(\"#[Platform]#showRankDialog\")\r\n        \r\n        // ViewManager.instance.show(\"Game/RankDialog\")\r\n    }\r\n\r\n    // Andriod 发送游戏快捷方式到桌面\r\n\r\n    static onEnterForeground()\r\n    {\r\n        console.log(\"=====================onEnterForeground=====================\")\r\n        if(cc.sys.platform == cc.sys.QQ_PLAY)\r\n        {\r\n            //onEnterForeground\r\n            // Device.resumeMusic()\r\n            cc.audioEngine.resumeMusic()\r\n        }else{\r\n            cc.audioEngine.resumeMusic()\r\n        }\r\n        Platform.onEnterForegroundSignal.fire();\r\n        event.emit(\"onEnterForeground\")\r\n    }\r\n\r\n    static onEnterBackground()\r\n    {\r\n        // BK.onEnterBackground(enterBackgroundListener);\r\n        event.emit(\"onEnterBackground\")\r\n    }\r\n\r\n    static  onGameExit()\r\n    {\r\n        // BK.onGameClose(gameCloseListener);\r\n    }\r\n\r\n    static showSmallRank()\r\n    {\r\n        wxsdk.postMessage(WxCommands.RankSmall);\r\n    }\r\n\r\n    static showRank()\r\n    {\r\n        wxsdk.postMessage(WxCommands.Rank);\r\n    }\r\n\r\n    static hideRank()\r\n    {\r\n        wxsdk.postMessage(WxCommands.RankSmall)\r\n    }\r\n\r\n    static getRankList(callback,target?)\r\n    {\r\n        console.log(\"[Platform]#获取排行榜数据\");\r\n        if(cc.sys.platform == cc.sys.QQ_PLAY)\r\n        {\r\n            return BKTool.getRankList((errorCode,list)=>{\r\n                callback && callback.call(target,errorCode,list);\r\n            })\r\n        }else if(cc.sys.platform == cc.sys.WECHAT_GAME)\r\n        {\r\n            \r\n        }\r\n    }\r\n\r\n    static uploadScore(score)\r\n    {\r\n        console.log(\"[Platform]#上传分数\");\r\n        if(!score) { console.log(\"score 上传失败：null\"); return}\r\n        if(cc.sys.platform == cc.sys.QQ_PLAY)\r\n        {\r\n            BKTool.uploadScore(score);\r\n        }else if (cc.sys.WECHAT_GAME == cc.sys.platform) {\r\n            // wxsdk.postMessage(WxCommands., score);\r\n            wxsdk.uploadScore(score)\r\n        }else{\r\n            // Toast.make(\"#[Platform]#uploadScore\")\r\n        }\r\n    }\r\n\r\n}"]}