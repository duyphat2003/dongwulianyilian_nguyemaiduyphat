{"version":3,"sources":["assets\\framework\\network\\MessageDispatch.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import {MessageBase} from \"./MessageBase\"\r\nexport class MessageDispatch{\r\n\r\n\tprivate static _instace: MessageDispatch = null;\r\n\r\n\tpublic static getInstance(){\r\n\t\tif(this._instace == null){\r\n\t\t\tthis._instace = new MessageDispatch();\r\n\t\t}\r\n\t\treturn this._instace;\r\n\t}\r\n\r\n\tprivate _handler: any;\r\n\tprivate _allMessageBases: {[key: string]: MessageBase[]};\r\n\r\n\tconstructor(){\r\n\t\tthis._handler = null;\r\n\t\tthis._allMessageBases = {};\r\n\t}\r\n\r\n\tpublic register(key: string, msgPro: MessageBase){\r\n\t\tif(key == null) return null;\r\n\t\tif(msgPro == null) return null;\r\n\t\tlet allBases = this._allMessageBases[key];\r\n\t\tif(allBases == null)this._allMessageBases[key] = [];\r\n\t\tthis._allMessageBases[key].push(msgPro);\r\n\t\treturn msgPro;\r\n\t}\r\n\r\n\tpublic isNull(key: string){\r\n\t\tlet allBases = this._allMessageBases[key];\r\n\t\tif(allBases != null && allBases.length > 0)\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic registerUnique(key: string, msgPro?: MessageBase){\r\n\t\tif(key == null ) return null;\r\n\t\tlet allBases = this._allMessageBases[key];\r\n\t\tif(allBases != null && allBases.length > 0)\r\n\t\t\treturn this._allMessageBases[key][0];\r\n\t\telse return this.register(key, msgPro);\r\n\t}\r\n\r\n\tpublic getBean(key: string) {\r\n\t\tif( key == null ) return null;\r\n\t\tlet allBeans = this._allMessageBases[key];\r\n\t\tif(allBeans != null && allBeans.length > 0){\r\n\t\t\treturn <any>allBeans[0];\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tpublic unRegister(key: string){\r\n\t\tlet allBases = this._allMessageBases[key];\r\n\t\tif(allBases == null) return;\r\n\t\tfor(let i = 0; i < allBases.length; i++)\r\n\t\t\tallBases[i].onDestory();\r\n\t\tthis._allMessageBases[key] = null;\r\n\t\tdelete this._allMessageBases[key];\r\n\t}\r\n\r\n\tpublic onMessage(msg: any){\r\n\t\tfor(let key in this._allMessageBases){\r\n\t\t\tif(this._allMessageBases[key]==null)continue;\r\n\t\t\tlet allBases = this._allMessageBases[key];\r\n\t\t\tfor(let i = 0; i < allBases.length; i++)\r\n\t\t\t\tif(allBases[i].onMessage(msg)) return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}"]}