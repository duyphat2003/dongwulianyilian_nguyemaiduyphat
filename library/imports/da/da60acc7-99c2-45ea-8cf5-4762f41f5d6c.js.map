{"version":3,"sources":["assets\\framework\\wxsdk\\MoreGameDialog.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import MoreGameManager from \"./MoreGameManager\";\nimport MoreGameItem from \"./MoreGameItem\";\n\n// Learn TypeScript:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class MoreGameDialog extends cc.Component {\n\n    @property(cc.Node)\n    root:cc.Node = null;\n\n    @property(cc.Sprite)\n    banner:cc.Sprite = null;\n\n    @property(cc.Label)\n    title:cc.Label = null;\n\n    @property(cc.Node)\n    template:cc.Node = null;\n\n    @property(cc.ScrollView)\n    scrollView:cc.ScrollView = null;\n\n\n    items : MoreGameItem[] = []\n\n    onLoad()\n    {\n        // this.template\n        \n    }\n\n    start () {\n        \n    }\n\n    updateChildWidget(node)\n    {\n        let widget = node.getComponent(cc.Widget);\n        if(widget) \n        {\n            widget.updateAlignment();\n        }\n    }\n\n    updateView()\n    {\n        let rect = this.banner.spriteFrame.getRect();\n        let size = this.root.getContentSize();\n        let ratio = size.width / rect.width;\n        let calcHeight = ratio * rect.height;\n        this.banner.sizeMode = cc.Sprite.SizeMode.RAW;\n        this.banner.node.height = calcHeight;\n        \n        let bannerWidget = this.banner.getComponent(cc.Widget);\n        bannerWidget.updateAlignment();\n\n        let scrollviewWidget = this.scrollView.getComponent(cc.Widget)\n        scrollviewWidget.top = calcHeight;\n        scrollviewWidget.updateAlignment();\n        g.foreachNode(this.scrollView.node,this.updateChildWidget,this)\n        // console.log(size ,rect,calcHeight);\n    }\n\n    onEnable()\n    {\n        this.scheduleOnce(this.updateView)\n        \n    }\n\n    async showBanner()\n    {\n        // this.banner.spriteFrame = await MoreGameManager.instance.getSpriteFrame(url);\n        let rect = this.banner.spriteFrame.getRect();\n        this.updateView();\n    }\n\n    toUserfriendlyNum(num:number)\n    {\n        if(num > 10000)\n        {\n            return (num/10000).toFixed(1) + \"ä¸‡\"\n        }\n        return num +\"\";\n    }\n\n    onShown()\n    {\n        this.showBanner()\n        let list = MoreGameManager.instance.gameList\n        this.scrollView.content.removeAllChildren();\n        this.items.splice(0,this.items.length)\n        for (var i = 0 ;i < list.length; i ++)\n        {\n            var cfg = list[i];\n            let node = cc.instantiate(this.template)\n            let item = node.getComponent(MoreGameItem)\n            item.title.string = cfg.title;\n            item.content.string = cfg.content\n            item.player_num.string = this.toUserfriendlyNum(cfg.players||100000)\n            item.setStar(cfg.star|| 4);\n            this.items.push(item);\n            this.scrollView.content.addChild(node)\n            if(item.btn.clickEvents.length > 0)\n                item.btn.clickEvents[0].customEventData = i +\"\";\n            if(item.btnSelf.clickEvents.length > 0)\n                item.btnSelf.clickEvents[0].customEventData = i +\"\";\n        }\n        this.showIcons()\n    }\n\n\n    async showIcons()\n    {\n        let list = MoreGameManager.instance.gameList\n        for (var i = 0 ;i < list.length; i ++)\n        {\n            var cfg = list[i];\n            let item = this.items[i]\n            item.icon.spriteFrame = await MoreGameManager.instance.getSpriteFrame(cfg.icon)\n        }\n    }\n\n    on_click_enter(sender,i)\n    {\n        let list = MoreGameManager.instance.gameList\n        var cfg = list[Number(i)]; \n        console.log(cfg)\n        MoreGameManager.instance.clickGame(cfg)\n    }\n\n    // update (dt) {}\n}\n"]}