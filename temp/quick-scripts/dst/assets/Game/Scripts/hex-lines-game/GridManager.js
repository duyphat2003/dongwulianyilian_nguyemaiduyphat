
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Game/Scripts/hex-lines-game/GridManager.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '3b45a0/RCtHwJWRliu8sGTN', 'GridManager');
// Game/Scripts/hex-lines-game/GridManager.ts

Object.defineProperty(exports, "__esModule", { value: true });
var IntMap_1 = require("./ds/IntMap");
var Game_1 = require("./Game");
var Res_1 = require("./Res");
var GridManager = /** @class */ (function (_super) {
    __extends(GridManager, _super);
    function GridManager() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._minCol = null;
        return _this;
    }
    GridManager.prototype.addGrid = function (t, e, n) {
        null == this._gridList && (this._gridList = new IntMap_1.default);
        if (!this._gridList.exists(t))
            this._gridList.set(t, new IntMap_1.default);
        this._gridList.get(t).set(e, n);
    };
    GridManager.prototype.init = function (t) {
        this._minCol = t;
    };
    GridManager.prototype.start = function () {
        var t = Game_1.default.instance._rowCount;
        var e = Game_1.default.instance._tileList;
        this._gridList = new IntMap_1.default;
        for (var n = 0; t > n;) {
            for (var i = n++, s = 0, a = (t / 2 >= i ? this._minCol + i : this._minCol - 1 + t - i) - 1; a > s;) {
                var r = s++;
                var o = e[i][r].get_borderPosition();
                var b = e[i][r + 1].get_borderPosition();
                var c = cc.v2((o.x + b.x) / 2, (o.y + b.y) / 2);
                var line = cc.instantiate(Res_1.R.Line46);
                line.setPosition(c);
                line.active = false;
                line.parent = this.node;
                line.zIndex = 109;
                this.addGrid(i + i, r + r + 1, line);
            }
        }
        for (n = 0, i = t / 2 | 0; i > n;)
            for (s = n++, a = t / 2 >= s ? this._minCol + s : this._minCol - 1 + t - s, r = 0; a > r;) {
                o = r++;
                for (var m_1 = 0; 2 > m_1; m_1++) {
                    var h = e[s][o].get_borderPosition();
                    var u = e[s + 1][o + m_1].get_borderPosition();
                    h = cc.v2((h.x + u.x) / 2, (h.y + u.y) / 2);
                    var line = null;
                    if (m_1 == 0) {
                        line = cc.instantiate(Res_1.R.Line37);
                    }
                    else {
                        line = cc.instantiate(Res_1.R.Line19);
                    }
                    line.setPosition(h);
                    line.active = false;
                    line.parent = this.node;
                    line.zIndex = 109;
                    this.addGrid(s + s + 1, o + o + m_1, line);
                }
            }
        for (n = 0, i = t / 2 | 0; i > n;)
            for (s = n++, s = t - s - 1, a = t / 2 >= s ? this._minCol + s : this._minCol - 1 + t - s, r = 0; a > r;) {
                o = r++;
                for (var m = 0; 2 > m; m++) {
                    h = e[s][o].get_borderPosition();
                    u = e[s - 1][o + m].get_borderPosition();
                    h = cc.v2((h.x + u.x) / 2, (h.y + u.y) / 2);
                    var line = null;
                    if (m == 0) {
                        line = cc.instantiate(Res_1.R.Line19);
                    }
                    else {
                        line = cc.instantiate(Res_1.R.Line37);
                    }
                    line.setPosition(h);
                    line.active = false;
                    line.zIndex = 109;
                    line.parent = this.node;
                    this.addGrid(s + s - 1, o + o + m, line);
                }
            }
    };
    GridManager.prototype.setState = function (r, c, r1, c1, b) {
        if (this._gridList.exists(r + r1)) {
            var t = this._gridList.get(r + r1);
            if (t.exists(c + c1)) {
                var node = t.get(c + c1);
                node.active = b;
            }
        }
    };
    return GridManager;
}(cc.Component));
exports.default = GridManager;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcR2FtZVxcU2NyaXB0c1xcaGV4LWxpbmVzLWdhbWVcXEdyaWRNYW5hZ2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxzQ0FBaUM7QUFDakMsK0JBQThCO0FBQzlCLDZCQUEwQjtBQUUxQjtJQUF5QywrQkFBWTtJQUFyRDtRQUFBLHFFQW1HQztRQS9GRyxhQUFPLEdBQUcsSUFBSSxDQUFDOztJQStGbkIsQ0FBQztJQTdGRyw2QkFBTyxHQUFQLFVBQVEsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDO1FBQ1gsSUFBSSxJQUFJLElBQUksQ0FBQyxTQUFTLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksZ0JBQU0sQ0FBQyxDQUFBO1FBQ3ZELElBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDeEIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksZ0JBQU0sQ0FBQyxDQUFBO1FBQ3JDLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7SUFDbkMsQ0FBQztJQUVELDBCQUFJLEdBQUosVUFBSyxDQUFDO1FBRUYsSUFBSSxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUE7SUFDcEIsQ0FBQztJQUVELDJCQUFLLEdBQUw7UUFDSSxJQUFJLENBQUMsR0FBRyxjQUFRLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQTtRQUNuQyxJQUFJLENBQUMsR0FBRyxjQUFRLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQTtRQUNuQyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksZ0JBQU0sQ0FBQztRQUM1QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUNyQjtZQUNJLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxF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QUUsQ0FBQyxDQUFBO1lBQ2xDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLEVBQ3BCO2dCQUNJLElBQUksSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFBO2dCQUN4QixJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQzthQUNuQjtTQUNKO0lBQ0wsQ0FBQztJQUNMLGtCQUFDO0FBQUQsQ0FuR0EsQUFtR0MsQ0FuR3dDLEVBQUUsQ0FBQyxTQUFTLEdBbUdwRCIsImZpbGUiOiIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJbnRNYXAgZnJvbSBcIi4vZHMvSW50TWFwXCI7XHJcbmltcG9ydCBMaW5lR2FtZSBmcm9tIFwiLi9HYW1lXCI7XHJcbmltcG9ydCB7IFIgfSBmcm9tIFwiLi9SZXNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdyaWRNYW5hZ2VyIGV4dGVuZHMgY2MuQ29tcG9uZW50XHJcbntcclxuICAgIF9ncmlkTGlzdDpJbnRNYXBcclxuXHJcbiAgICBfbWluQ29sID0gbnVsbDtcclxuXHJcbiAgICBhZGRHcmlkKHQsIGUsIG4pIHtcclxuICAgICAgICBudWxsID09IHRoaXMuX2dyaWRMaXN0ICYmICh0aGlzLl9ncmlkTGlzdCA9IG5ldyBJbnRNYXApXHJcbiAgICAgICAgaWYoIXRoaXMuX2dyaWRMaXN0LmV4aXN0cyh0KSlcclxuICAgICAgICAgICAgdGhpcy5fZ3JpZExpc3Quc2V0KHQsIG5ldyBJbnRNYXApXHJcbiAgICAgICAgdGhpcy5fZ3JpZExpc3QuZ2V0KHQpLnNldChlLCBuKVxyXG4gICAgfVxyXG5cclxuICAgIGluaXQodClcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9taW5Db2wgPSB0XHJcbiAgICB9XHJcblxyXG4gICAgc3RhcnQoKSB7XHJcbiAgICAgICAgdmFyIHQgPSBMaW5lR2FtZS5pbnN0YW5jZS5fcm93Q291bnRcclxuICAgICAgICB2YXIgZSA9IExpbmVHYW1lLmluc3RhbmNlLl90aWxlTGlzdFxyXG4gICAgICAgIHRoaXMuX2dyaWRMaXN0ID0gbmV3IEludE1hcDtcclxuICAgICAgICBmb3IgKHZhciBuID0gMDsgdCA+IG47KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IG4rKywgcyA9IDAsIGEgPSAodCAvIDIgPj0gaSA/IHRoaXMuX21pbkNvbCArIGkgOiB0aGlzLl9taW5Db2wgLSAxICsgdCAtIGkpIC0gMTsgYSA+IHM7KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgciA9IHMrK1xyXG4gICAgICAgICAgICAgICAgdmFyIG8gPSBlW2ldW3JdLmdldF9ib3JkZXJQb3NpdGlvbigpXHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGVbaV1bciArIDFdLmdldF9ib3JkZXJQb3NpdGlvbigpXHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGNjLnYyKChvLnggKyBiLngpIC8gMiwoby55ICsgYi55KSAvIDIpXHJcbiAgICAgICAgICAgICAgICBsZXQgbGluZSA9IGNjLmluc3RhbnRpYXRlKFIuTGluZTQ2KVxyXG4gICAgICAgICAgICAgICAgbGluZS5zZXRQb3NpdGlvbihjKTtcclxuICAgICAgICAgICAgICAgIGxpbmUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBsaW5lLnBhcmVudCA9IHRoaXMubm9kZTtcclxuICAgICAgICAgICAgICAgIGxpbmUuekluZGV4ID0gMTA5XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEdyaWQoaSArIGksIHIgKyByICsgMSwgbGluZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKG4gPSAwLCBpID0gdCAvIDIgfCAwOyBpID4gbjspXHJcbiAgICAgICAgICAgIGZvciAocyA9IG4rKywgYSA9IHQgLyAyID49IHMgPyB0aGlzLl9taW5Db2wgKyBzIDogdGhpcy5fbWluQ29sIC0gMSArIHQgLSBzLCByID0gMDsgYSA+IHI7KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBvID0gciArK1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgbSA9IDA7IDIgPiBtO20rKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBoID0gZVtzXVtvXS5nZXRfYm9yZGVyUG9zaXRpb24oKVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1ID0gZVtzICsgMV1bbyArIG1dLmdldF9ib3JkZXJQb3NpdGlvbigpXHJcbiAgICAgICAgICAgICAgICAgICAgaCA9IGNjLnYyKChoLnggKyB1LngpIC8gMiwgKGgueSArIHUueSkgLyAyKVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBsaW5lID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBpZihtID09IDApXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZSA9IGNjLmluc3RhbnRpYXRlKFIuTGluZTM3KVxyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lID0gY2MuaW5zdGFudGlhdGUoUi5MaW5lMTkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxpbmUuc2V0UG9zaXRpb24oaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGluZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lLnBhcmVudCA9IHRoaXMubm9kZTtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lLnpJbmRleCA9IDEwOVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkR3JpZChzICsgcyArIDEsIG8gKyBvICsgbSwgbGluZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIGZvciAobiA9IDAsIGkgPSB0IC8gMiB8IDA7IGkgPiBuOylcclxuICAgICAgICAgICAgZm9yIChzID0gbisrLCBzID0gdCAtIHMgLSAxLCBhID0gdCAvIDIgPj0gcyA/IHRoaXMuX21pbkNvbCArIHMgOiB0aGlzLl9taW5Db2wgLSAxICsgdCAtIHMsIHIgPSAwOyBhID4gcjspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG8gPSByKytcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIG0gID0gMDsgMiA+IG07bSsrKSBcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBoID0gZVtzXVtvXS5nZXRfYm9yZGVyUG9zaXRpb24oKVxyXG4gICAgICAgICAgICAgICAgICAgIHUgPSBlW3MgLSAxXVtvICsgbV0uZ2V0X2JvcmRlclBvc2l0aW9uKClcclxuICAgICAgICAgICAgICAgICAgICBoID0gY2MudjIoKGgueCArIHUueCkgLyAyLCAoaC55ICsgdS55KSAvIDIpXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxpbmUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKG0gPT0gMClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUgPSBjYy5pbnN0YW50aWF0ZShSLkxpbmUxOSlcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUgPSBjYy5pbnN0YW50aWF0ZShSLkxpbmUzNylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGluZS5zZXRQb3NpdGlvbihoKTtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmUuekluZGV4ID0gMTA5XHJcbiAgICAgICAgICAgICAgICAgICAgbGluZS5wYXJlbnQgPSB0aGlzLm5vZGU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkR3JpZChzICsgcyAtIDEsIG8gKyBvICsgbSwgbGluZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgc2V0U3RhdGUociwgYywgcjEsIGMxLCBiKSB7XHJcbiAgICAgICAgaWYodGhpcy5fZ3JpZExpc3QuZXhpc3RzKHIgKyByMSkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBsZXQgdCA9IHRoaXMuX2dyaWRMaXN0LmdldChyICsgcjEpXHJcbiAgICAgICAgICAgIGlmICh0LmV4aXN0cyhjICsgYzEpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IHQuZ2V0KGMgKyBjMSlcclxuICAgICAgICAgICAgICAgIG5vZGUuYWN0aXZlID0gYjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==