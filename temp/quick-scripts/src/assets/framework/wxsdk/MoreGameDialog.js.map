{"version":3,"sources":["assets\\framework\\wxsdk\\MoreGameDialog.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import MoreGameManager from \"./MoreGameManager\";\r\nimport MoreGameItem from \"./MoreGameItem\";\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class MoreGameDialog extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    root:cc.Node = null;\r\n\r\n    @property(cc.Sprite)\r\n    banner:cc.Sprite = null;\r\n\r\n    @property(cc.Label)\r\n    title:cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    template:cc.Node = null;\r\n\r\n    @property(cc.ScrollView)\r\n    scrollView:cc.ScrollView = null;\r\n\r\n\r\n    items : MoreGameItem[] = []\r\n\r\n    onLoad()\r\n    {\r\n        // this.template\r\n        \r\n    }\r\n\r\n    start () {\r\n        \r\n    }\r\n\r\n    updateChildWidget(node)\r\n    {\r\n        let widget = node.getComponent(cc.Widget);\r\n        if(widget) \r\n        {\r\n            widget.updateAlignment();\r\n        }\r\n    }\r\n\r\n    updateView()\r\n    {\r\n        let rect = this.banner.spriteFrame.getRect();\r\n        let size = this.root.getContentSize();\r\n        let ratio = size.width / rect.width;\r\n        let calcHeight = ratio * rect.height;\r\n        this.banner.sizeMode = cc.Sprite.SizeMode.RAW;\r\n        this.banner.node.height = calcHeight;\r\n        \r\n        let bannerWidget = this.banner.getComponent(cc.Widget);\r\n        bannerWidget.updateAlignment();\r\n\r\n        let scrollviewWidget = this.scrollView.getComponent(cc.Widget)\r\n        scrollviewWidget.top = calcHeight;\r\n        scrollviewWidget.updateAlignment();\r\n        g.foreachNode(this.scrollView.node,this.updateChildWidget,this)\r\n        // console.log(size ,rect,calcHeight);\r\n    }\r\n\r\n    onEnable()\r\n    {\r\n        this.scheduleOnce(this.updateView)\r\n        \r\n    }\r\n\r\n    async showBanner()\r\n    {\r\n        // this.banner.spriteFrame = await MoreGameManager.instance.getSpriteFrame(url);\r\n        let rect = this.banner.spriteFrame.getRect();\r\n        this.updateView();\r\n    }\r\n\r\n    toUserfriendlyNum(num:number)\r\n    {\r\n        if(num > 10000)\r\n        {\r\n            return (num/10000).toFixed(1) + \"ä¸‡\"\r\n        }\r\n        return num +\"\";\r\n    }\r\n\r\n    onShown()\r\n    {\r\n        this.showBanner()\r\n        let list = MoreGameManager.instance.gameList\r\n        this.scrollView.content.removeAllChildren();\r\n        this.items.splice(0,this.items.length)\r\n        for (var i = 0 ;i < list.length; i ++)\r\n        {\r\n            var cfg = list[i];\r\n            let node = cc.instantiate(this.template)\r\n            let item = node.getComponent(MoreGameItem)\r\n            item.title.string = cfg.title;\r\n            item.content.string = cfg.content\r\n            item.player_num.string = this.toUserfriendlyNum(cfg.players||100000)\r\n            item.setStar(cfg.star|| 4);\r\n            this.items.push(item);\r\n            this.scrollView.content.addChild(node)\r\n            if(item.btn.clickEvents.length > 0)\r\n                item.btn.clickEvents[0].customEventData = i +\"\";\r\n            if(item.btnSelf.clickEvents.length > 0)\r\n                item.btnSelf.clickEvents[0].customEventData = i +\"\";\r\n        }\r\n        this.showIcons()\r\n    }\r\n\r\n\r\n    async showIcons()\r\n    {\r\n        let list = MoreGameManager.instance.gameList\r\n        for (var i = 0 ;i < list.length; i ++)\r\n        {\r\n            var cfg = list[i];\r\n            let item = this.items[i]\r\n            item.icon.spriteFrame = await MoreGameManager.instance.getSpriteFrame(cfg.icon)\r\n        }\r\n    }\r\n\r\n    on_click_enter(sender,i)\r\n    {\r\n        let list = MoreGameManager.instance.gameList\r\n        var cfg = list[Number(i)]; \r\n        console.log(cfg)\r\n        MoreGameManager.instance.clickGame(cfg)\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}