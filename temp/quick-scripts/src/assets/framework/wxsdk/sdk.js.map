{"version":3,"sources":["assets\\framework\\wxsdk\\sdk.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { event } from \"../plugin_boosts/utils/EventManager\";\r\nimport { GameConfig } from \"./GameConfigs\";\r\n\r\nclass Global\r\n{\r\n    static videoAd= undefined\r\n    static bannerAd= undefined\r\n\r\n    static videoAdLoadCount= 0 //视频广告加载次数\r\n    static bannerAdLoadCount= 0 //banner广告加载次数\r\n}\r\nclass WxSdk {\r\n    \r\n    _userInfo: any;\r\n    _parentId: any;\r\n    _shareConfig: any;\r\n    _db:any;\r\n    _version: number;\r\n    _systemInfo:any;\r\n\r\n    public get Ver(): number { return this._version; }\r\n    init() {\r\n        if(g.iswxgame()) {\r\n            if(this._version == null)\r\n            {\r\n                this._systemInfo = wx.getSystemInfoSync();\r\n                let ver = this._systemInfo.SDKVersion.replace(/\\./g, \"\")\r\n                this._version = parseInt(ver);\r\n            }\r\n        }\r\n    }\r\n\r\n    requestDB(tbname,callback,target)\r\n    {\r\n        this._db.collection(tbname).get({\r\n            success: function(res){\r\n                console.log(\"get \"+ tbname +\" succ:\" , res.data)\r\n                // self._shareConfig = res.data;\r\n                if(callback)callback.call(target,res.data);\r\n            }, fail: (res)=>{\r\n                console.log(\"get \"+ tbname +\" fail:\")\r\n                if(callback) callback.call(target)\r\n            }\r\n        });\r\n    }\r\n\r\n    requestConfig(callback)\r\n    {\r\n        this._db.collection(\"t_conf\").get({\r\n            success: function(res){\r\n                console.log(\"get configs succ:\" , res.data)\r\n                // self._shareConfig = res.data;\r\n                if(callback)callback(res.data);\r\n            }, fail: (res)=>{\r\n                console.log(\"get configs fail:\" , res)\r\n                if(callback) callback(null)\r\n            }\r\n        });\r\n    }\r\n\r\n    private requestShareContent(callback) {\r\n        let self = this;\r\n        if(this._shareConfig == null) {\r\n            this._db.collection(\"t_share\").get({\r\n                success: function(res){\r\n                    console.log(\"share configs succ:\" , res.data)\r\n                    self._shareConfig = res.data;\r\n                    if(res.data && res.data.length > 0) {\r\n                        let len = res.data.length;\r\n                        let info = res.data[g.randomInt(0, len)];\r\n                        if(callback)callback(info);\r\n                    } else{\r\n                        if(callback) callback(null)\r\n                    }\r\n                }, fail: (res)=>{\r\n                    console.log(\"share configs fail:\" , res)\r\n                    if(callback) callback(null)\r\n                }\r\n            });\r\n        } else {\r\n            let len = this._shareConfig.length;\r\n            let info = this._shareConfig[g.randomInt(0, len)];\r\n            if(callback) callback(info);\r\n        }\r\n    }\r\n\r\n    getShareContentSync()\r\n    {\r\n        if(this._shareConfig && this._shareConfig.length > 0)\r\n        {\r\n            let len = this._shareConfig.length;\r\n            let info = this._shareConfig[g.randomInt(0, len)];\r\n            return info\r\n        }else{\r\n            return {title:GameConfig.default_share_title,imageUrl:cc.url.raw(GameConfig.deafult_share_imgUrl)}\r\n        }\r\n        \r\n    }\r\n\r\n    private getShareContent(title?):Promise<{title:string,imageUrl:string,query?:string,success?:(res:any)=>void}> {\r\n        return new Promise((resolve,reject)=>{\r\n            this.requestShareContent(info=>{\r\n                if(info)\r\n                    resolve(info)\r\n                else {\r\n                    // reject(\"share config get failed!\")\r\n                    let ret= {\r\n                        title: title || GameConfig.default_share_title,\r\n                        imageUrl: cc.url.raw(GameConfig.deafult_share_imgUrl),\r\n                        // imageUrl: \"https://7465-tes-313f56-1257630180.tcb.qcloud.la/share/xuanchuan_1.png?sign=651306ddcd9dd2f24ea14d24e1dadc0e&t=1537024558\",\r\n                    }\r\n                    resolve(ret);\r\n                }\r\n            })\r\n        })\r\n    }\r\n\r\n    async openShare(title? ,uuid?,extra = \"\") {\r\n        if(!g.iswxgame()) return;\r\n        let info = await this.getShareContent(title);\r\n        console.log(info);\r\n        if(info != null) {\r\n            // if(this._userInfo && this._userInfo.openId)\r\n            uuid = uuid || (this._userInfo &&this._userInfo.openId) || 0\r\n            info.query = \"share_id=\"+uuid + \"&time=\"+ new Date().getTime() + \"&\" +extra;\r\n            // info.callback = ret=>{\r\n            //     console.error(\"=>>>>>>>share:\" ,ret);\r\n            // }\r\n            console.log(\"open Share\",info.query)\r\n            wx.shareAppMessage(info);\r\n            // this.recordShare(Share.GAME, uuid);\r\n        }\r\n    }\r\n\r\n    private createButton(callback, x?, y?, width?, height?) {\r\n        console.log(\"-------------createButton\");\r\n        let button = wx.createUserInfoButton({\r\n            type: \"text\",\r\n            text:\"     \",\r\n            style: {\r\n                x: x || 0, y: y || 0,\r\n                width: width || cc.winSize.width,\r\n                height: height || cc.winSize.height,\r\n                lineHeight:40,\r\n                backgroundColor:'#00000000',\r\n                color:'#ffffff'\r\n            }\r\n        });\r\n        button.onTap(function(res){\r\n            button.destroy();\r\n            if(res && res.userInfo) {\r\n                if(callback) callback(res);\r\n            } else if(callback) callback(null);\r\n        });\r\n    }\r\n\r\n    get userInfo(){\r\n        return this._userInfo.userInfo;\r\n    }\r\n\r\n    private getUserInfo(callback) {\r\n        console.log(\"-------------getUserInfo\");\r\n        wx.getUserInfo({\r\n            withCredentials: true,\r\n            lang: \"zh_CN\",\r\n            success: (res)=>{\r\n                console.log(\"getUserInfo success.\", res);\r\n                if(callback) callback(res);\r\n            }, fail: (res)=>{\r\n                console.log(\"getUserInfo:\", res);\r\n                if(callback) callback(null);\r\n            },\r\n            complete: null\r\n        });         \r\n    }\r\n\r\n    oldAuthUser(callback) {\r\n        wx.authorize({\r\n            scope: \"scope.userInfo\",\r\n            success: (res)=>{\r\n                console.log(res);\r\n                if(callback) callback(true);\r\n            }, fail: (res)=>{\r\n                console.log(res);\r\n                if(callback) callback(false);\r\n            }, complete: null\r\n        });\r\n    }\r\n\r\n    authUserInfo(callback) {\r\n\r\n        this.wxLogin((isLogin)=>{\r\n            if(!isLogin) return;\r\n            wx.getSetting({\r\n                success: (res)=>{\r\n                    let auth = res.authSetting;\r\n                    if(auth[\"scope.userInfo\"]){\r\n                        if(callback) callback(true);\r\n                    } else if(callback) callback(false);\r\n                }, fail: null,\r\n                complete: null,\r\n            });\r\n        });\r\n    }\r\n\r\n\r\n    showShareMenu() {\r\n        let self = this;\r\n        wx.showShareMenu({\r\n            withShareTicket: true,\r\n            success: (res)=>{\r\n                console.log(res);\r\n            },fail: (res)=>{\r\n                console.log(res);\r\n            },complete: null\r\n        });\r\n        wx.onShareAppMessage(function(){\r\n            let content = self.getShareContentSync();\r\n            return content;\r\n        });\r\n    }\r\n\r\n\r\n    private wxLogin(callback) {\r\n        wx.login({\r\n            success: (res)=>{\r\n                console.log(\"code \", res.code);\r\n                if(callback) callback(true);\r\n            }, fail: (res)=>{\r\n                if(callback) callback(false);\r\n            }, complete: null\r\n        });\r\n    }\r\n\r\n\r\n    private loginToServer(userInfo) {\r\n        if(userInfo==null) userInfo={};\r\n        this._userInfo = userInfo;\r\n        userInfo.parentId = this._parentId;\r\n        this.showShareMenu();\r\n        event.emit(\"wxlogin\");\r\n        \r\n    }\r\n\r\n    public login(x?, y?, width?, height?){\r\n        if(!g.iswxgame())return\r\n        let self = this;\r\n        wx.cloud.init({traceUser: true});\r\n        // this._db = wx.cloud.database({env: \"release-2c87c4\"});//测试环境\r\n        this._db = wx.cloud.database();\r\n\r\n        self.authUserInfo((isAuth)=>{\r\n            if(self._userInfo == null || \r\n                self._userInfo.userInfo == null){\r\n                if(self._version >= 220 && !isAuth) {\r\n                    self.createButton((userInfo)=>{\r\n                        self.loginToServer(userInfo);\r\n                    }, x, y, width, height);\r\n                } else {\r\n                    if(!isAuth){ self.oldAuthUser((isAuth)=>{\r\n                        if(isAuth) {\r\n                            self.getUserInfo((userInfo)=>{\r\n                                self.loginToServer(userInfo);     \r\n                            });\r\n                        }else self.loginToServer(null);\r\n                    })} else self.getUserInfo((userInfo)=>{\r\n                        self.loginToServer(userInfo);\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    public getParent() {\r\n        if(!g.iswxgame()) return \"\"\r\n        let info = wx.getLaunchOptionsSync();\r\n        if(info.scene == 1007 || info.scene == 1008) {//通过分享进入游戏\r\n            let openId = info.query[\"user_id\"];\r\n            return openId\r\n        }\r\n        return \"\"; //默认\r\n    }\r\n\r\n    //发送消息到子域\r\n    public postMessage(cmd, data?) {\r\n        if(g.iswxgame()) {\r\n            wx.getOpenDataContext().postMessage({\r\n                cmd: cmd,\r\n                data: data\r\n            });\r\n        }\r\n    }\r\n\r\n    public uploadScore(score,callback?)\r\n    {\r\n        var kvDataList=new Array();\r\n        kvDataList.push({\r\n            key:\"score\",\r\n            value:score+\"\"\r\n        });\r\n\r\n        let obj = {\r\n            KVDataList:kvDataList,\r\n            success:function(d){\r\n                if(callback) callback(d)\r\n            },\r\n            fail:function(){},\r\n            complete:function(){},\r\n        }\r\n        wx.setUserCloudStorage(obj)\r\n        // \"wxgame\": {\r\n        //     \"score\": 16,\r\n        //     \"update_time\": 1513080573\r\n        // },\r\n        // \"cost_ms\": 36500\r\n    }\r\n\r\n    public loadBannerAd(callback?){\r\n        if(Global.bannerAd)\r\n        {\r\n            Global.bannerAd.destroy()\r\n        }\r\n        if(!this._systemInfo)\r\n            this._systemInfo = wx.getSystemInfoSync();\r\n        let bannerAd = wx.createBannerAd({\r\n            adUnitId: 'adunit-fe3c074ad86d1b59',\r\n            style: {\r\n                left: 0,\r\n                top: 0,//cc.visibleRect.height\r\n                width: this._systemInfo.windowWidth\r\n            }\r\n        })\r\n        bannerAd.onLoad(()=>{\r\n            Global.bannerAd = bannerAd;\r\n            Global.bannerAdLoadCount = 0;\r\n            bannerAd.style.left = this._systemInfo.windowWidth/2 - bannerAd.style.realWidth/2;\r\n            bannerAd.style.top = this._systemInfo.windowHeight - bannerAd.style.realHeight;\r\n            if(callback) callback(\"load\" ,bannerAd)\r\n        })\r\n        bannerAd.onError((err) =>{\r\n            //加载失败\r\n            console.log(\"wxsdk onError code:\" + err.code + \" msg:\" + err.msg);\r\n            Global.bannerAdLoadCount += 1;\r\n            if (Global.bannerAdLoadCount < 4) {\r\n                this.loadBannerAd(callback);\r\n            }\r\n            if(callback) callback(\"error\")\r\n        });\r\n    }\r\n\r\n    public showBannerAd(): any {\r\n        console.log(\"Wxsdk 显示banner广告\",Global.bannerAd)\r\n        if (Global.bannerAd) {\r\n            Global.bannerAd.show();\r\n        } else {\r\n            console.log(\"Wxsdk 不存在banner资源....\");\r\n            this.loadBannerAd((v,ad)=>{\r\n                if(v==\"load\")\r\n                {\r\n                    this.showBannerAd()\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    hideBannerAd() {\r\n        if (Global.bannerAd) {\r\n            Global.bannerAd.hide();\r\n            // Global.bannerAd = null;\r\n        } \r\n    }\r\n\r\n    loadVideoAd(callback) {\r\n        console.log(\"============wxsdk.loadVideoAD\");\r\n        // if (!Global.videoAd ) { //如果没有广告资源就加载新的视频广告\r\n        let videoAd = wx.createRewardedVideoAd({\r\n            adUnitId: 'adunit-5214efbe348a768c'\r\n        })\r\n        this.hideBannerAd();\r\n        videoAd.load().then(()=>{videoAd.show();});\r\n        videoAd.onError(err=> {\r\n            //加载失败\r\n            Global.videoAdLoadCount += 1;\r\n            //尝试4次\r\n            if (Global.videoAdLoadCount < 4) {\r\n                this.loadVideoAd(callback);\r\n            }\r\n            if(callback) callback(\"error\")\r\n        });\r\n\r\n        videoAd.onClose(function (ret) {\r\n            //播放结束\r\n            console.log(\"wxsdk onClose...\");\r\n            if(callback) callback(\"close\",ret.isEnded)\r\n            Global.videoAd = null;\r\n        });\r\n\r\n        videoAd.onLoad(()=>{\r\n            //加载成功\r\n            console.log(\"wxsdk onLoad\");\r\n            Global.videoAd = videoAd;\r\n            Global.videoAdLoadCount = 0;\r\n            this.showBannerAd();\r\n            if(callback) callback(\"load\" , videoAd)\r\n        });\r\n    }\r\n\r\n}\r\n\r\nexport let wxsdk:WxSdk = new WxSdk();"]}