{"version":3,"sources":["assets\\Game\\Scripts\\Info.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DataCenter, { dc, field } from \"../../framework/plugin_boosts/misc/DataCenter\";\r\nimport { R } from \"./hex-lines-game/Res\";\r\nimport { Toast } from \"../../framework/plugin_boosts/ui/ToastManager\";\r\nimport Device from \"../../framework/plugin_boosts/gamesys/Device\";\r\nimport Platform from \"../../framework/Platform\";\r\nimport MoreGameManager from \"../../framework/wxsdk/MoreGameManager\";\r\n\r\n\r\nexport enum ChoiceType  {\r\n    DailyGet,\r\n    Levelup,\r\n    Get,\r\n    Shop,\r\n    BannerAdRefresh,\r\n    HB,\r\n}\r\n\r\n@dc(\"Info\")\r\nexport default class UserInfoClass extends DataCenter\r\n{\r\n    choices:[] = []\r\n    version:string = \"6\";\r\n    // ret: 0:directly-get 1:share 2:video\r\n    getChoice(slotId)\r\n    {\r\n        return this.choices[slotId] || 0;\r\n    }\r\n\r\n    init()\r\n    {\r\n        Platform.configGetSignal.on(this.onGetConfig,this);\r\n        Platform.requestServerConfigs(\"t_games\",this.onGetGames,this)\r\n    }\r\n\r\n    onGetGames(data)\r\n    {\r\n        MoreGameManager.instance.addList(data);\r\n    }\r\n\r\n    onGetConfig(data)\r\n    {\r\n        if(data)\r\n        {\r\n            let record = data[0]\r\n            if(record)\r\n            {\r\n                this.choices = JSON.parse(record[this.version])\r\n            }\r\n        } \r\n        Platform.initBannerAd(this.getChoice(ChoiceType.BannerAdRefresh))\r\n    }\r\n\r\n    @field()\r\n    level:number = 1;\r\n\r\n    @field()\r\n    selectedSkin:string = \"2\";\r\n\r\n    @field()\r\n    dailyGetTime:number =  new Date(2018,1,1).getTime();\r\n\r\n    @field()\r\n    freedrawTime:number = this.dailyGetTime;\r\n\r\n    @field()\r\n    luckyVideoWatchTime:number = this.dailyGetTime\r\n\r\n    @field()\r\n    shopFreeDiamondTime:number = this.dailyGetTime;\r\n\r\n    @field()\r\n    diamond:number = 0;\r\n\r\n    @field()\r\n    sfx_enabled:boolean = true;\r\n\r\n    @field()\r\n    firstTimeReach:boolean = false;\r\n\r\n    @field()\r\n    luckyVideoWatchCount:number = 0;\r\n    timePassed: number = 0;\r\n    stepUsed: number = 0;\r\n\r\n    addDiamond(d,b = true)\r\n    {\r\n        if(typeof(d) == \"number\") this.diamond += d;\r\n        else this.diamond += parseInt(d);\r\n        if(b)\r\n        {\r\n            Toast.make(\"获得钻石 x\" + d)\r\n            Device.playEffect(R.audio_get_diamond);\r\n        }\r\n        if(!this.firstTimeReach)\r\n        {\r\n            if(this.diamond >= 500)\r\n            {\r\n                Toast.make(\"哇可以买皮肤了，快去皮肤商店看看吧!\",2)\r\n                this.firstTimeReach = true\r\n                UserInfo.save();\r\n            }\r\n        }\r\n    }\r\n\r\n    currentLevel:number = 1;\r\n\r\n    constructor()\r\n    {\r\n        super();\r\n        this.unlock(this.selectedSkin);\r\n        setTimeout(()=>{\r\n            this.save();\r\n        }, 60 * 1000)\r\n        // onexit game =>save\r\n    }\r\n\r\n    isUnlock(skin_id)\r\n    {\r\n        let carUnlocked =  localStorage.getItem(\"unlocked_\"+skin_id);\r\n        if(!carUnlocked)\r\n        {\r\n            return false\r\n        }else\r\n        {\r\n            return carUnlocked == \"1\"\r\n        }\r\n    }\r\n\r\n    isAllUnlocked()\r\n    {\r\n        let c = 0;\r\n        for(var i = 0 ;i <R.skinConfig.json.length;i++)\r\n        {\r\n            var v = R.skinConfig.json[i]\r\n            if(UserInfo.isUnlock(v.id))\r\n            {\r\n                c ++\r\n            }\r\n        }   \r\n        return c == R.skinConfig.json.length\r\n    }\r\n\r\n\r\n    getSkinById(id: any): any {\r\n        let res = R.skinConfig.json.filter(v=>{return v.id == id});\r\n        return res[0]\r\n    }\r\n\r\n\r\n    unlock(skin_id)\r\n    {\r\n        localStorage.setItem(\"unlocked_\"+skin_id , \"1\")\r\n    }\r\n\r\n}\r\nexport var UserInfo:UserInfoClass = DataCenter.register(UserInfoClass)"]}