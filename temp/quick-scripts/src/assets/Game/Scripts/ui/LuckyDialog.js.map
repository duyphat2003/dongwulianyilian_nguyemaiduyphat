{"version":3,"sources":["assets\\Game\\Scripts\\ui\\LuckyDialog.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Toast } from \"../../../framework/plugin_boosts/ui/ToastManager\";\r\nimport ViewManager from \"../../../framework/plugin_boosts/ui/ViewManager\";\r\nimport View from \"../../../framework/plugin_boosts/ui/View\";\r\nimport { UserInfo } from \"../Info\";\r\nimport Platform from \"../../../framework/Platform\";\r\nimport Device from \"../../../framework/plugin_boosts/gamesys/Device\";\r\nimport { R } from \"../hex-lines-game/Res\";\r\nimport UIFunctions from \"../../../framework/plugin_boosts/ui/UIFunctions\";\r\nimport Main from \"../Main\";\r\nimport LanguageManager, { LanguageMode } from \"../LanguageManager\";\r\nimport AddToMyFav from \"../../../framework/wxsdk/AddToMyFav\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class LuckyDialog extends cc.Component {\r\n\r\n\r\n    onEnable() {\r\n            switch (LanguageManager.instance.currentLanguage) {\r\n            case LanguageMode.CN:\r\n                this.set_label_lang('正在给您挑选奖品',\r\n                    '正在给您挑选奖品',\r\n                    '恭喜你抽中了',\r\n                    \"免费一次\",\r\n                    \"观看视频\",\r\n                    \"幸运转盘\",\r\n                    );\r\n                    this.set_label_FontSize(this.ch_FontSize);\r\n                break;\r\n            case LanguageMode.VI:\r\n                this.set_label_lang( 'Chọn giải thưởng cho bạn',\r\n                    'Chọn giải thưởng cho bạn',\r\n                    'Xin chúc mừng chiến thắng',\r\n                    \"Miễn phí một lần\",\r\n                    \"Xem video\",\r\n                    \"Vòng quay may mắn\",\r\n                );\r\n                    this.set_label_FontSize(this.vi_FontSize);\r\n                break;\r\n            case LanguageMode.EN:\r\n                this.set_label_lang('Selecting prizes for you',\r\n                    'Selecting prizes for you',\r\n                    'Congratulations on winning',\r\n                    \"Free once\",\r\n                    \"Watch the video\",\r\n                    \"Lucky Wheel\",\r\n                    );\r\n                    this.set_label_FontSize(this.eng_FontSize);\r\n                break;\r\n        }\r\n    }\r\n\r\n    @property(cc.Sprite)\r\n    wheelSp: cc.Sprite\r\n\r\n    @property(cc.SpriteFrame)\r\n    misterySp: cc.SpriteFrame\r\n\r\n    _canRotate = true;\r\n\r\n    @property([cc.Sprite])\r\n    sprites:cc.Sprite[] = []\r\n\r\n    @property([cc.Label])\r\n    labels:cc.Label[] = []\r\n\r\n    @property(cc.Button)\r\n    btn_freedraw:cc.Button = null;\r\n\r\n    @property(cc.Button)\r\n    btn_videodraw:cc.Button = null;\r\n\r\n    @property(cc.Node)\r\n    freedrawTip:cc.Node = null;\r\n\r\n\r\n    @property(cc.Label)\r\n    drawLabel:cc.Label = null;\r\n    @property(cc.Label)\r\n    freeDrawLabel:cc.Label = null;\r\n    @property(cc.Label)\r\n    watchVideoLabel:cc.Label = null;\r\n    @property(cc.Label)\r\n    bannerLabel:cc.Label = null;\r\n\r\n    static MaxVideoCount = 5;\r\n\r\n    // click_draw()\r\n    // {\r\n\r\n    // }\r\n\r\n    @property({ type: cc.Integer })\r\n    ch_FontSize: number = 0;\r\n    @property({ type: cc.Integer })\r\n    vi_FontSize: number = 0;\r\n    @property({ type: cc.Integer })\r\n    eng_FontSize: number = 0;\r\n\r\n    set_label_FontSize(fontSize: number) {\r\n        this.freeDrawLabel.fontSize = fontSize;\r\n        this.watchVideoLabel.fontSize = fontSize;\r\n        this.bannerLabel.fontSize = fontSize;\r\n    }\r\n\r\n    pool = []\r\n    \r\n\r\n    share_succ()\r\n    {\r\n        this.startDraw();\r\n        UserInfo.freedrawTime = new Date().getTime()\r\n        UserInfo.save()\r\n        Main.instance.refreshRedpoints()\r\n        this.onShown();\r\n    }\r\n\r\n    click_freeedraw()\r\n    {\r\n        if (g.isNextDay(UserInfo.freedrawTime))\r\n        {\r\n            this.share_succ()\r\n        }\r\n    }\r\n\r\n    onLoad () {\r\n        for (var i = 0 ;i < R.luckyConfig.json.length; i ++)\r\n        {\r\n            var cfg = R.luckyConfig.json[i];\r\n            let chance = parseFloat(cfg.chance)\r\n            for (var j = 0 ; j < chance * 2 ; j++)\r\n            {\r\n                this.pool.push(i);\r\n            }\r\n        }\r\n        this.pool.shuffle()\r\n        console.log(this.pool);\r\n    }\r\n\r\n\r\n    startDraw()\r\n    {\r\n        let id = g.getRandomInArray(this.pool)\r\n        this.startWheel(id)\r\n        Device.playEffect(R.audio_draw);\r\n    }\r\n\r\n    // 5次\r\n    click_videodraw()\r\n    {\r\n        if (UserInfo.luckyVideoWatchCount >= LuckyDialog.MaxVideoCount)\r\n        {\r\n            if(g.isNextDay(UserInfo.luckyVideoWatchTime))\r\n            {\r\n                UserInfo.luckyVideoWatchCount = 0;\r\n                UserInfo.luckyVideoWatchTime = new Date().getTime();\r\n            }else{\r\n                // Platform.share(_=>{\r\n                //     this.startDraw()\r\n                // })\r\n                return;\r\n            }\r\n        }else{\r\n            Platform.watch_video(_=>{\r\n                UserInfo.luckyVideoWatchCount ++ \r\n                this.startDraw()\r\n            })\r\n        }\r\n        //video 流量主开通后\r\n        // Platform.watch_video(_=>{\r\n        //     this.startDraw()\r\n        //     UserInfo.luckyVideoWatchCount += 1;\r\n        //     UserInfo.save();\r\n        //     this.onShown()\r\n        //     // Toast.make(\"还剩\" +  (5- UserInfo.luckyVideoWatchCount) +\"次机会\")\r\n        // });\r\n    }\r\n\r\n\r\n    calculateAngle(index:number){//奖品的index从0开始\r\n        let angle = -(index-1) * 60 - 30  -  4 * 360 -  this.wheelSp.node.rotation %360 \r\n        return angle\r\n    }\r\n\r\n    onShown()\r\n    {\r\n        if (UserInfo.luckyVideoWatchCount >=  LuckyDialog.MaxVideoCount)\r\n        {\r\n            switch (LanguageManager.instance.currentLanguage) {\r\n                case LanguageMode.CN:\r\n                    this.drawLabel.string = '已用完';\r\n                    this.drawLabel.fontSize = this.ch_FontSize;\r\n                    break;\r\n                case LanguageMode.VI:\r\n                    this.drawLabel.string = 'Kiệt sức';\r\n                    this.drawLabel.fontSize = this.vi_FontSize;\r\n                    break;\r\n                case LanguageMode.EN:\r\n                    this.drawLabel.string = 'Exhausted';\r\n                    this.drawLabel.fontSize = this.eng_FontSize;\r\n                    break;\r\n            }\r\n            UIFunctions.setButtonEnabled(this.btn_videodraw,false)\r\n        } else {\r\n            switch (LanguageManager.instance.currentLanguage) {\r\n                case LanguageMode.CN:\r\n                    this.drawLabel.string = '看视频抽奖';\r\n                    this.drawLabel.fontSize = this.ch_FontSize;\r\n                    break;\r\n                case LanguageMode.VI:\r\n                    this.drawLabel.string = 'Xem video và giành giải thưởng';\r\n                    this.drawLabel.fontSize = this.vi_FontSize;\r\n                    break;\r\n                case LanguageMode.EN:\r\n                    this.drawLabel.string = 'Watch the video and win the prize';\r\n                    this.drawLabel.fontSize = this.eng_FontSize;\r\n                    break;\r\n            }\r\n            UIFunctions.setButtonEnabled(this.btn_videodraw,true)\r\n        }\r\n        if (g.isGreaterDate(new Date(),  new Date(UserInfo.freedrawTime)) )\r\n        {\r\n            //free draw \r\n            this.btn_freedraw.interactable = true\r\n            this.btn_freedraw.node.opacity = 255;\r\n            this.freedrawTip.active = false\r\n        }else{\r\n            this.btn_freedraw.interactable = false\r\n            this.btn_freedraw.node.opacity = 100;\r\n            this.freedrawTip.active = true;\r\n        }\r\n\r\n        for (var i = 0 ; i< R.luckyConfig.json.length; i ++)\r\n        {\r\n            let cfg = R.luckyConfig.json[i]\r\n            this.labels[i].string = cfg.gold_reward + \"\"\r\n\r\n            if (this.sprites[i].spriteFrame == this.misterySp) {\r\n\r\n            }\r\n        }\r\n        switch (LanguageManager.instance.currentLanguage) {\r\n            case LanguageMode.CN:\r\n                this.labels[2].string = '神秘皮肤';\r\n                this.labels[2].fontSize = this.ch_FontSize;\r\n                break;\r\n            case LanguageMode.VI:\r\n                this.labels[2].string = 'Trang phục bí ẩn';\r\n                this.labels[2].fontSize = this.vi_FontSize;\r\n                break;\r\n            case LanguageMode.EN:\r\n                this.labels[2].string = 'Mysterious Skin';\r\n                this.labels[2].fontSize = this.eng_FontSize;\r\n                break;\r\n        }\r\n\r\n    }\r\n\r\n    startWheelMessage: string = \"\";\r\n    showResMessage: string = \"\";\r\n    startWheel(id)\r\n    {\r\n        console.log(\"target wheel:\" ,id);\r\n        let angle = this.calculateAngle(id)\r\n        if (!this._canRotate){\r\n            Toast.make(this.startWheelMessage + '...');\r\n            return\r\n        }\r\n        this._canRotate = false\r\n\r\n        let stage3 = cc.rotateBy(Math.abs(angle/400),angle)\r\n        let callFunc = cc.callFunc(function(){\r\n            this._canRotate = true\r\n            this.showRes(id)\r\n        }.bind(this))\r\n        let sequence = cc.sequence(stage3,callFunc)\r\n        this.wheelSp.node.runAction(sequence.easing(cc.easeQuadraticActionInOut()))\r\n    }\r\n\r\n    showRes(id)\r\n    {\r\n        let cfg = R.luckyConfig.json[id]\r\n        let gold = !isNaN((Number(cfg.gold_reward)))\r\n        if(gold)\r\n        {\r\n            this.getComponent(View).hide()\r\n            ViewManager.instance.show(\"Game/GetDialog\",cfg.gold_reward)\r\n        }\r\n        else{\r\n            //神秘\r\n            Toast.make(this.showResMessage + \" \" + cfg.gold_reward);\r\n            UserInfo.unlock(g.randomInt(0,6));\r\n            // Device.playEffect(R.audio_unlock);\r\n        }\r\n    }\r\n\r\n\r\n    set_label_lang(clickCloseMessage_text: string,\r\n        startWheelMessage_text: string,\r\n        showResMessage_text: string,\r\n        freeDrawString: string,\r\n        watchVideoString: string,\r\n        bannerString: string,\r\n    ) {\r\n        this.clickCloseMessage = clickCloseMessage_text;\r\n        this.startWheelMessage = startWheelMessage_text;\r\n        this.showResMessage = showResMessage_text;\r\n        this.freeDrawLabel.string = freeDrawString;\r\n        this.watchVideoLabel.string = watchVideoString;\r\n        this.bannerLabel.string = bannerString;\r\n    }\r\n\r\n    clickCloseMessage: string; \r\n    click_close()\r\n    {\r\n        if (!this._canRotate){\r\n            Toast.make(this.clickCloseMessage + '...');\r\n            return \r\n        }\r\n        this.getComponent(View).hide()\r\n    }\r\n\r\n\r\n}"]}